<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>openalea.grapheditor.qtutils &mdash; OpenAlea community website</title>
    
    <link rel="stylesheet" href="../../../_static/virtualplants.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="OpenAlea community website" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">OpenAlea community website</a> &raquo;</li>
          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for openalea.grapheditor.qtutils</h1><div class="highlight"><pre>
<span class="c"># -*- python -*-</span>
<span class="c">#</span>
<span class="c">#       OpenAlea.Visualea: OpenAlea graphical user interface</span>
<span class="c">#</span>
<span class="c">#       Copyright 2006-2009 INRIA - CIRAD - INRA</span>
<span class="mi">1</span><span class="c">#</span>
<span class="c">#       File author(s): Daniel Barbeau &lt;daniel.barbeau@sophia.inria.fr&gt;</span>
<span class="c">#</span>
<span class="c">#       Distributed under the Cecill-C License.</span>
<span class="c">#       See accompanying file LICENSE.txt or copy at</span>
<span class="c">#           http://www.cecill.info/licences/Licence_CeCILL-C_V1-en.html</span>
<span class="c">#</span>
<span class="c">#       OpenAlea WebSite : http://openalea.gforge.inria.fr</span>
<span class="c">#</span>
<span class="c">###############################################################################</span>

<span class="n">__license__</span> <span class="o">=</span> <span class="s">&quot;Cecill-C&quot;</span>
<span class="n">__revision__</span> <span class="o">=</span> <span class="s">&quot; $Id$ &quot;</span>


<span class="kn">import</span> <span class="nn">weakref</span>
<span class="kn">from</span> <span class="nn">openalea.vpltk.qt</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>


<span class="c">##################################################################################</span>
<span class="c"># Some PYQT versions don&#39;t know about some QGraphicsItem flags or enums yet      #</span>
<span class="c"># even though the underlying Qt knows about it (.sip files not up-to-date        #</span>
<span class="c"># when building PyQt). The differences between PYQT_VERSION 4.6.2 and 4.7.3 are: #</span>
<span class="c">##################################################################################</span>
<span class="n">unportableFlags</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ItemSendsGeometryChanges&#39;</span><span class="p">,</span> <span class="s">&#39;ItemUsesExtendedStyleOption&#39;</span><span class="p">,</span>
                   <span class="s">&#39;ItemScenePositionHasChanged&#39;</span><span class="p">,</span> <span class="s">&#39;ItemAcceptsInputMethod&#39;</span><span class="p">,</span> <span class="s">&#39;ItemSendsScenePositionChanges&#39;</span><span class="p">,</span>
                   <span class="s">&#39;ItemHasNoContents&#39;</span><span class="p">,</span> <span class="s">&#39;ItemNegativeZStacksBehindParent&#39;</span><span class="p">,</span> <span class="s">&#39;ItemIsPanel&#39;</span><span class="p">]</span>
<span class="n">unportableEnums</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;ItemScenePositionHasChanged&quot;</span><span class="p">,</span> <span class="s">&quot;ItemPositionHasChanged&quot;</span><span class="p">]</span>

<span class="n">__dict__</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>
<span class="n">__badsymbols</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">unportableFlags</span><span class="o">+</span><span class="n">unportableEnums</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">__dict__</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsItem</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">__badsymbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">continue</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">__badsymbols</span><span class="p">):</span>
    <span class="k">print</span> \
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The following QtGui.QGraphicsItem enums and flags were not found.</span>
<span class="sd">These are probably used by a graph view. They might exist but your version</span>
<span class="sd">of PyQt is too old so openalea.grapheditor.qtutils will try to compensate</span>
<span class="sd">them:</span>
<span class="sd">%s</span>
<span class="sd">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">__badsymbols</span><span class="p">)</span>

<span class="c"># if it&#39;s just the PyQt Version that is too old we have a hack as</span>
<span class="c"># the qt flag exists but is simply not exposed.</span>
<span class="c"># this is not bug free: if the Qt guys change the enum order, we&#39;re wrecked.</span>
<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">QtCore</span><span class="p">,</span> <span class="s">&#39;PYQT_VERSION&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">PYQT_VERSION</span> <span class="o">&lt;</span> <span class="mh">0x040703</span> <span class="ow">and</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">PYQT_VERSION</span> <span class="o">&gt;=</span> <span class="mh">0x040600</span><span class="p">:</span>
    <span class="c"># -- flags --</span>
    <span class="n">ItemSendsGeometryChanges</span> <span class="o">=</span> <span class="mh">0x800</span>
    <span class="n">ItemSendsScenePositionChanges</span> <span class="o">=</span> <span class="mh">0xffff</span>
    <span class="c"># -- enums --</span>
    <span class="n">ItemScenePositionHasChanged</span> <span class="o">=</span> <span class="mh">0x1b</span>
    <span class="n">ItemPositionHasChanged</span> <span class="o">=</span> <span class="mh">0x9</span>


<span class="c">#####################################################</span>
<span class="c"># A Global to know if using QGraphicsEffect is safe #</span>
<span class="c">#####################################################</span>
<span class="n">safeEffects</span> <span class="o">=</span> <span class="bp">False</span> <span class="c">#QtCore.QT_VERSION &gt;= 0x40600 and QtCore.PYQT_VERSION &gt; 0x40704</span>


<span class="c">#######################################</span>
<span class="c"># A very simple signal implementation #</span>
<span class="c">#######################################</span>
<div class="viewcode-block" id="AleaSignal"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaSignal">[docs]</a><span class="k">class</span> <span class="nc">AleaSignal</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">types</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">types</span>     <span class="o">=</span> <span class="n">types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakKeyDictionary</span><span class="p">()</span>
<div class="viewcode-block" id="AleaSignal.connect"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaSignal.connect">[docs]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">callback</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span></div>
<div class="viewcode-block" id="AleaSignal.disconnect"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaSignal.disconnect">[docs]</a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">callbacks</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>
<div class="viewcode-block" id="AleaSignal.emit"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaSignal.emit">[docs]</a>    <span class="k">def</span> <span class="nf">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="c"># TODO: do type checking?</span>
        <span class="n">callbacks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">values</span><span class="p">()[:]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
            <span class="n">c</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="c">###############################################</span>
<span class="c"># A QGraphicsWidget that looks like a post-it #</span>
<span class="c">###############################################</span></div></div>
<div class="viewcode-block" id="MemoRects"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.MemoRects">[docs]</a><span class="k">class</span> <span class="nc">MemoRects</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">):</span>
    <span class="n">__handleSize</span>    <span class="o">=</span> <span class="mf">7.5</span>
    <span class="n">__defaultColor</span>  <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__resizing</span>   <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__handlePoly</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPolygonF</span><span class="p">([</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">__handleSize</span><span class="p">),</span>
                                             <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                             <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">__handleSize</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFlag</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsItem</span><span class="o">.</span><span class="n">ItemStacksBehindParent</span><span class="p">)</span>
        <span class="c"># -- handle --</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__handlePos</span>  <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="c"># -- header --</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__headerContentRect</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__headerRect</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># -- color --</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color</span>       <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__darkerColor</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shadowColor</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__defaultColor</span><span class="o">.</span><span class="n">darker</span><span class="p">(</span><span class="mi">110</span><span class="p">))</span>
        <span class="c"># -- optionnal cosmetics --</span>
        <span class="k">if</span> <span class="n">safeEffects</span><span class="p">:</span>
            <span class="n">fx</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsDropShadowEffect</span><span class="p">()</span>
            <span class="n">fx</span><span class="o">.</span><span class="n">setOffset</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fx</span><span class="o">.</span><span class="n">setBlurRadius</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setGraphicsEffect</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span>

<div class="viewcode-block" id="MemoRects.setColor"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.MemoRects.setColor">[docs]</a>    <span class="k">def</span> <span class="nf">setColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color</span>       <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__darkerColor</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">darker</span><span class="p">(</span><span class="mi">140</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shadowColor</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">darker</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">__moveHandleBottomRightTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">point</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__handlePos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__handlePoly</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">delta</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__handlePos</span> <span class="o">=</span> <span class="n">point</span>

<div class="viewcode-block" id="MemoRects.setHeaderRect"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.MemoRects.setHeaderRect">[docs]</a>    <span class="k">def</span> <span class="nf">setHeaderRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
        <span class="n">myRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__headerContentRect</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="c">#copy</span>

        <span class="n">rect</span><span class="o">.</span><span class="n">setX</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">rect</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">myRect</span><span class="o">.</span><span class="n">setX</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">myRect</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rect</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">myRect</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">__handleSize</span><span class="p">):</span>
            <span class="n">myRect</span><span class="o">.</span><span class="n">setBottom</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__handleSize</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">myRect</span><span class="o">.</span><span class="n">right</span><span class="p">():</span>
            <span class="n">myRect</span><span class="o">.</span><span class="n">setRight</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rect</span><span class="o">.</span><span class="n">setRight</span><span class="p">(</span><span class="n">myRect</span><span class="o">.</span><span class="n">right</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__headerRect</span> <span class="o">=</span> <span class="n">rect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__moveHandleBottomRightTo</span><span class="p">(</span><span class="n">myRect</span><span class="o">.</span><span class="n">bottomRight</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="n">myRect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MemoRects.mousePressEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.MemoRects.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">pos</span>         <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span>
        <span class="n">bottomRight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">bottomRight</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span>        <span class="o">=</span> <span class="n">bottomRight</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">bottomRight</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__handlePoly</span><span class="o">.</span><span class="n">containsPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">OddEvenFill</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__resizing</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MemoRects.mouseMoveEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.MemoRects.mouseMoveEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseMoveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__resizing</span><span class="p">:</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span> <span class="o">-</span> <span class="n">event</span><span class="o">.</span><span class="n">lastPos</span><span class="p">()</span>
            <span class="n">bottomRight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">bottomRight</span><span class="p">()</span> <span class="o">+</span> <span class="n">delta</span>
            <span class="n">newRect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="n">bottomRight</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">bottomRight</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">newRect</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__headerContentRect</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">__handleSize</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="n">newRect</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__headerRect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span>
                                                  <span class="n">bottomRight</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">__headerContentRect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__moveHandleBottomRightTo</span><span class="p">(</span><span class="n">newRect</span><span class="o">.</span><span class="n">bottomRight</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="n">mouseMoveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MemoRects.mouseReleaseEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.MemoRects.mouseReleaseEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__resizing</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__resizing</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="n">mouseReleaseEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MemoRects.paint"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.MemoRects.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">paintOptions</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="n">myRect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">fillRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__headerRect</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__darkerColor</span><span class="p">)</span>
        <span class="n">gradTop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__headerRect</span><span class="o">.</span><span class="n">bottomLeft</span><span class="p">()</span>
        <span class="n">gradBot</span> <span class="o">=</span> <span class="n">gradTop</span> <span class="o">+</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">gradient</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QLinearGradient</span><span class="p">(</span><span class="n">gradTop</span><span class="p">,</span><span class="n">gradBot</span><span class="p">)</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__shadowColor</span><span class="p">)</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__color</span><span class="p">)</span>
        <span class="n">brush</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">gradient</span><span class="p">)</span>

        <span class="n">bottomRect</span> <span class="o">=</span> <span class="n">myRect</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">__headerRect</span><span class="o">.</span><span class="n">bottom</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">fillRect</span><span class="p">(</span><span class="n">bottomRect</span><span class="p">,</span> <span class="n">brush</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">safeEffects</span><span class="p">:</span>
            <span class="n">oldPen</span> <span class="o">=</span> <span class="n">painter</span><span class="o">.</span><span class="n">pen</span><span class="p">()</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">()</span>
            <span class="n">pen</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
            <span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">myRect</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">oldPen</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__darkerColor</span><span class="p">))</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawConvexPolygon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__handlePoly</span><span class="p">)</span>


<span class="c">###############################################</span>
<span class="c"># A Vanishing GraphicsItem mixing. Appears on #</span>
<span class="c"># hover in and vanishes on hover out          #</span>
<span class="c">###############################################</span></div></div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin">[docs]</a><span class="k">class</span> <span class="nc">AleaQGraphicsVanishingMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__baseOpacity</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">__numFrames</span>   <span class="o">=</span> <span class="mi">24</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vanishingTime</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">baseOpacity</span><span class="o">=</span><span class="n">__baseOpacity</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAcceptHoverEvents</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__baseOpacity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vanEnabled</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vanishingTime</span> <span class="o">=</span> <span class="n">vanishingTime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="p">(</span><span class="n">vanishingTime</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setFrameRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__numFrames</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">frameChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__onFrameChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lowOpacity</span> <span class="o">=</span> <span class="n">baseOpacity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__toSleep</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__sleeping</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__lowOpacity</span><span class="p">)</span>

<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.setBaseOpactity"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.setBaseOpactity">[docs]</a>    <span class="k">def</span> <span class="nf">setBaseOpactity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opacity</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lowOpacity</span> <span class="o">=</span> <span class="n">opacity</span>
</div>
    <span class="k">def</span> <span class="nf">__onFrameChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">frame</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">__lowOpacity</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">__numFrames</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lowOpacity</span>
        <span class="k">if</span> <span class="n">opacity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lowOpacity</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__toSleep</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__sleeping</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>

<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.setVanishingEnabled"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.setVanishingEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">setVanishingEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vanEnabled</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">state</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Running</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Backward</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">appear</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">disappear</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.setVanishingTime"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.setVanishingTime">[docs]</a>    <span class="k">def</span> <span class="nf">setVanishingTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vanishingTime</span> <span class="o">=</span> <span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.vanishingTime"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.vanishingTime">[docs]</a>    <span class="k">def</span> <span class="nf">vanishingTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__vanishingTime</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.wakeup"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.wakeup">[docs]</a>    <span class="k">def</span> <span class="nf">wakeup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__sleeping</span> <span class="o">=</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.sleep"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.sleep">[docs]</a>    <span class="k">def</span> <span class="nf">sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__sleeping</span> <span class="o">=</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.setSleepOnDisappear"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.setSleepOnDisappear">[docs]</a>    <span class="k">def</span> <span class="nf">setSleepOnDisappear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__toSleep</span> <span class="o">=</span> <span class="n">val</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.disappear"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.disappear">[docs]</a>    <span class="k">def</span> <span class="nf">disappear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__vanEnabled</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opacity</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lowOpacity</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">state</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__vanishingTime</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span>  <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Running</span> <span class="ow">and</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">direction</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Forward</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setDirection</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Backward</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">NotRunning</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setCurrentTime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">duration</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setDirection</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Backward</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.appear"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.appear">[docs]</a>    <span class="k">def</span> <span class="nf">appear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__sleeping</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__vanEnabled</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opacity</span><span class="p">()</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">state</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__vanishingTime</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span>  <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Running</span> <span class="ow">and</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">direction</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Backward</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setDirection</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Forward</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">NotRunning</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setCurrentTime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">setDirection</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QTimeLine</span><span class="o">.</span><span class="n">Forward</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.hoverEnterEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.hoverEnterEvent">[docs]</a>    <span class="k">def</span> <span class="nf">hoverEnterEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appear</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsVanishingMixin.hoverLeaveEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsVanishingMixin.hoverLeaveEvent">[docs]</a>    <span class="k">def</span> <span class="nf">hoverLeaveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disappear</span><span class="p">()</span>


<span class="c">###########################################</span>
<span class="c"># A button like mixin for qgraphics items #</span>
<span class="c">###########################################</span></div></div>
<div class="viewcode-block" id="AleaQGraphicsButtonMixin"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsButtonMixin">[docs]</a><span class="k">class</span> <span class="nc">AleaQGraphicsButtonMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAcceptedMouseButtons</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pressed</span> <span class="o">=</span> <span class="n">AleaSignal</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="s">&quot;_onButtonPressed&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_onButtonPressed</span><span class="p">)</span>

<div class="viewcode-block" id="AleaQGraphicsButtonMixin.mousePressEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsButtonMixin.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsButtonMixin.mouseReleaseEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsButtonMixin.mouseReleaseEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mouseReleaseEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mouseReleaseEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pressed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

<span class="c">########################</span>
<span class="c"># A horizontal toolbar #</span>
<span class="c">########################</span></div></div>
<div class="viewcode-block" id="AleaQGraphicsToolbar"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsToolbar">[docs]</a><span class="k">class</span> <span class="nc">AleaQGraphicsToolbar</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">,</span> <span class="n">AleaQGraphicsVanishingMixin</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">AleaQGraphicsVanishingMixin</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFlag</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsItem</span><span class="o">.</span><span class="n">ItemIgnoresTransformations</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__layout</span> <span class="o">=</span> <span class="n">HorizontalLayout</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="p">(</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">),</span>
                                         <span class="n">innerMargins</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                         <span class="n">mins</span><span class="o">=</span><span class="p">(</span><span class="mf">20.</span><span class="p">,</span><span class="mf">20.</span><span class="p">))</span>

<div class="viewcode-block" id="AleaQGraphicsToolbar.refreshGeometry"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsToolbar.refreshGeometry">[docs]</a>    <span class="k">def</span> <span class="nf">refreshGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__layout</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__layout</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsToolbar.addItem"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsToolbar.addItem">[docs]</a>    <span class="k">def</span> <span class="nf">addItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__layout</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>


<span class="c">#############################################################</span>
<span class="c"># Customized Qt Classes that can be reused in other places. #</span>
<span class="c">#############################################################</span></div></div>
<div class="viewcode-block" id="AleaQGraphicsRoundedRectItem"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsRoundedRectItem">[docs]</a><span class="k">class</span> <span class="nc">AleaQGraphicsRoundedRectItem</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__useCachedPath</span> <span class="o">=</span> <span class="n">cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cachedPath</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_cached_shape</span><span class="p">()</span>

<div class="viewcode-block" id="AleaQGraphicsRoundedRectItem.shape"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsRoundedRectItem.shape">[docs]</a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__useCachedPath</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cachedPath</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_path</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_make_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pen</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pen</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
        <span class="n">penWidth</span> <span class="o">=</span> <span class="n">pen</span><span class="o">.</span><span class="n">widthF</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainterPath</span><span class="p">()</span>
        <span class="n">path</span><span class="o">.</span><span class="n">addRoundedRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span><span class="o">.</span><span class="n">adjusted</span><span class="p">(</span><span class="n">penWidth</span><span class="p">,</span> <span class="n">penWidth</span><span class="p">,</span>
                                                 <span class="o">-</span><span class="n">penWidth</span><span class="p">,</span> <span class="o">-</span><span class="n">penWidth</span><span class="p">),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radius</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>

<div class="viewcode-block" id="AleaQGraphicsRoundedRectItem.refresh_cached_shape"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsRoundedRectItem.refresh_cached_shape">[docs]</a>    <span class="k">def</span> <span class="nf">refresh_cached_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cachedPath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_path</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsRoundedRectItem.paint"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsRoundedRectItem.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pen</span><span class="p">())</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brush</span><span class="p">())</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">())</span>
</div></div>
<div class="viewcode-block" id="AleaQGraphicsEmitingTextItem"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsEmitingTextItem">[docs]</a><span class="k">class</span> <span class="nc">AleaQGraphicsEmitingTextItem</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A QtGui.QGraphicsTextItem that emits geometryModified whenever</span>
<span class="sd">    its geometry can have changed.&quot;&quot;&quot;</span>

    <span class="c">######################</span>
    <span class="c"># The Missing Signal #</span>
    <span class="c">######################</span>
    <span class="n">geometryModified</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">contentsChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__onDocumentChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hoveredIn</span> <span class="o">=</span> <span class="n">AleaSignal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hoveredOut</span> <span class="o">=</span> <span class="n">AleaSignal</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__onDocumentChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometryModified</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span>

<div class="viewcode-block" id="AleaQGraphicsEmitingTextItem.hoverEnterEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsEmitingTextItem.hoverEnterEvent">[docs]</a>    <span class="k">def</span> <span class="nf">hoverEnterEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="o">.</span><span class="n">hoverEnterEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hoveredIn</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsEmitingTextItem.hoverLeaveEvent"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsEmitingTextItem.hoverLeaveEvent">[docs]</a>    <span class="k">def</span> <span class="nf">hoverLeaveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsTextItem</span><span class="o">.</span><span class="n">hoverLeaveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hoveredOut</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>



<span class="c">###########</span>
<span class="c"># Buttons #</span>
<span class="c">###########</span>
</div></div>
<div class="viewcode-block" id="AleaQGraphicsColorWheel"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsColorWheel">[docs]</a><span class="k">class</span> <span class="nc">AleaQGraphicsColorWheel</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsEllipseItem</span><span class="p">,</span> <span class="n">AleaQGraphicsVanishingMixin</span><span class="p">,</span> <span class="n">AleaQGraphicsButtonMixin</span><span class="p">):</span>
    <span class="n">_stopHues</span>    <span class="o">=</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="p">,</span><span class="mi">360</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">_stopPos</span>     <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">12</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">12</span><span class="p">)]</span>
    <span class="c">######################</span>
    <span class="c"># The Missing Signal #</span>
    <span class="c">######################</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsEllipseItem</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">radius</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">radius</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">AleaQGraphicsVanishingMixin</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">AleaQGraphicsButtonMixin</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colorChanged</span> <span class="o">=</span> <span class="n">AleaSignal</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">)</span>
        <span class="n">gradient</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QConicalGradient</span><span class="p">()</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">setCenter</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">hue</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_stopHues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopPos</span><span class="p">):</span>
            <span class="n">gradient</span><span class="o">.</span><span class="n">setColorAt</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="o">.</span><span class="n">fromHsv</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">gradient</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_onButtonPressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QColorDialog</span><span class="o">.</span><span class="n">getColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">white</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">color</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">colorChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsFontButton"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsFontButton">[docs]</a><span class="k">class</span> <span class="nc">AleaQGraphicsFontButton</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsSimpleTextItem</span><span class="p">,</span> <span class="n">AleaQGraphicsButtonMixin</span><span class="p">):</span>
    <span class="n">_fontSize</span><span class="o">=</span><span class="mi">24</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QGraphicsSimpleTextItem</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">AleaQGraphicsButtonMixin</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font</span><span class="p">()</span>
        <span class="n">font</span><span class="o">.</span><span class="n">setPixelSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fontSize</span><span class="p">)</span>
        <span class="n">font</span><span class="o">.</span><span class="n">setBold</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fontChanged</span> <span class="o">=</span> <span class="n">AleaSignal</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_onButtonPressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">font</span><span class="p">,</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontDialog</span><span class="o">.</span><span class="n">getFont</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AleaQGraphicsFontColorButton"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQGraphicsFontColorButton">[docs]</a><span class="k">class</span> <span class="nc">AleaQGraphicsFontColorButton</span><span class="p">(</span><span class="n">AleaQGraphicsFontButton</span><span class="p">):</span>
    <span class="n">_fontSize</span><span class="o">=</span><span class="mi">24</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">AleaQGraphicsFontButton</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fontColorChanged</span> <span class="o">=</span> <span class="n">AleaSignal</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">)</span>
        <span class="c"># gradient = QtGui.QConicalGradient()</span>
        <span class="c"># gradient.setCenter(self.boundingRect().center())</span>
        <span class="c"># for hue, pos in zip(AleaQGraphicsColorWheel._stopHues, AleaQGraphicsColorWheel._stopPos):</span>
        <span class="c">#     gradient.setColorAt(pos, QtGui.QColor.fromHsv(hue, 255, 255, 255))</span>
        <span class="c"># self.setBrush(QtGui.QBrush(gradient))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_onButtonPressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QColorDialog</span><span class="o">.</span><span class="n">getColor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">white</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">widget</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">color</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontColorChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

<span class="c">#####################################</span>
<span class="c"># Simple layouts for QGraphicsItems #</span>
<span class="c">#####################################</span></div>
<div class="viewcode-block" id="Layout"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout">[docs]</a><span class="k">class</span> <span class="nc">Layout</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">final</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span>
                 <span class="n">innerMargins</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">center</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">mins</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="o">=</span> <span class="n">final</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y2</span> <span class="o">=</span> <span class="n">margins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ix1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iy1</span> <span class="o">=</span> <span class="n">innerMargins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_minWidth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minHeight</span> <span class="o">=</span> <span class="n">mins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_boundCache</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">parent</span><span class="p">:</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Layout.clear"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="o">=</span> <span class="bp">None</span>
</div>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">_items</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">__iter__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

<div class="viewcode-block" id="Layout.center"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.center">[docs]</a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="o">=</span> <span class="n">val</span>
</div>
<div class="viewcode-block" id="Layout.sort"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">cmp</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="nb">cmp</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Layout.addFinalItem"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.addFinalItem">[docs]</a>    <span class="k">def</span> <span class="nf">addFinalItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="o">=</span> <span class="n">item</span>
</div>
<div class="viewcode-block" id="Layout.addItem"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.addItem">[docs]</a>    <span class="k">def</span> <span class="nf">addItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Layout.removeItem"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.removeItem">[docs]</a>    <span class="k">def</span> <span class="nf">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Layout.boundingRect"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.boundingRect">[docs]</a>    <span class="k">def</span> <span class="nf">boundingRect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundCache</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingRect</span><span class="p">()</span>
            <span class="n">w</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minWidth</span><span class="p">)</span>
            <span class="n">h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minHeight</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_boundCache</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">boundCache</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundCache</span>
</div>
    <span class="k">def</span> <span class="nf">_boundingRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<div class="viewcode-block" id="Layout.setPos"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.setPos">[docs]</a>    <span class="k">def</span> <span class="nf">setPos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</div>
<div class="viewcode-block" id="Layout.setMinimumSize"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.setMinimumSize">[docs]</a>    <span class="k">def</span> <span class="nf">setMinimumSize</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">width</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minWidth</span> <span class="o">=</span> <span class="n">width</span>
        <span class="k">if</span> <span class="n">height</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_minHeight</span> <span class="o">=</span> <span class="n">height</span>
</div>
<div class="viewcode-block" id="Layout.setMargins"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.setMargins">[docs]</a>    <span class="k">def</span> <span class="nf">setMargins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">y1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x1</span><span class="o">=</span><span class="n">x1</span>
        <span class="k">if</span> <span class="n">x2</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x2</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span>
        <span class="k">if</span> <span class="n">y1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span><span class="o">=</span><span class="n">y1</span>
        <span class="k">if</span> <span class="n">y2</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y2</span><span class="o">=</span><span class="n">y2</span>
</div>
<div class="viewcode-block" id="Layout.setInnerMargins"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.setInnerMargins">[docs]</a>    <span class="k">def</span> <span class="nf">setInnerMargins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ix1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">iy1</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ix1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ix1</span><span class="o">=</span><span class="n">ix1</span>
        <span class="k">if</span> <span class="n">iy1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iy1</span><span class="o">=</span><span class="n">iy1</span>
</div>
<div class="viewcode-block" id="Layout.isVisible"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.isVisible">[docs]</a>    <span class="k">def</span> <span class="nf">isVisible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="Layout.visibleItems"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.Layout.visibleItems">[docs]</a>    <span class="k">def</span> <span class="nf">visibleItems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcall</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">i</span> <span class="k">if</span> <span class="n">subcall</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">subcall</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">isVisible</span><span class="p">()</span> <span class="p">]</span>
</div></div>
<div class="viewcode-block" id="HorizontalLayout"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.HorizontalLayout">[docs]</a><span class="k">class</span> <span class="nc">HorizontalLayout</span><span class="p">(</span><span class="n">Layout</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_boundingRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x2</span>
        <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y2</span>
        <span class="n">geoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibleItems</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span>
        <span class="n">lenGeoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">geoms</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lenGeoms</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">width</span>  <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span> <span class="n">g</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">geoms</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">lenGeoms</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_ix1</span>
            <span class="n">height</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">g</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">geoms</span> <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
            <span class="n">width</span>  <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
            <span class="n">height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="p">)</span>
        <span class="k">return</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span>

<div class="viewcode-block" id="HorizontalLayout.setPos"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.HorizontalLayout.setPos">[docs]</a>    <span class="k">def</span> <span class="nf">setPos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span><span class="p">)</span>
        <span class="n">innerOffset</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ix1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iy1</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibleItems</span><span class="p">()</span>
        <span class="n">selfHeight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">itRect</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="p">:</span>
                <span class="n">offset</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="p">(</span><span class="n">selfHeight</span> <span class="o">-</span> <span class="n">itRect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
            <span class="n">it</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="n">itRect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="mf">0.</span><span class="p">)</span> <span class="o">+</span> <span class="n">innerOffset</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="p">:</span>
                <span class="n">offset</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">+</span><span class="p">(</span><span class="n">selfHeight</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">())</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="VerticalLayout"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.VerticalLayout">[docs]</a><span class="k">class</span> <span class="nc">VerticalLayout</span><span class="p">(</span><span class="n">Layout</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_boundingRect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x2</span>
        <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y2</span>
        <span class="n">geoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibleItems</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span>
        <span class="n">lenGeoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">geoms</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lenGeoms</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">width</span>  <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">g</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">geoms</span> <span class="p">)</span>
            <span class="n">height</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span> <span class="n">g</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">geoms</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">lenGeoms</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_iy1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
            <span class="n">width</span>  <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
            <span class="n">height</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="k">return</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span>

<div class="viewcode-block" id="VerticalLayout.setPos"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.VerticalLayout.setPos">[docs]</a>    <span class="k">def</span> <span class="nf">setPos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y1</span><span class="p">)</span>
        <span class="n">innerOffset</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ix1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iy1</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibleItems</span><span class="p">()</span>
        <span class="n">selfWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">itRect</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="p">:</span>
                <span class="n">offset</span><span class="o">.</span><span class="n">setX</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">+</span><span class="p">(</span><span class="n">selfWidth</span> <span class="o">-</span> <span class="n">itRect</span><span class="o">.</span><span class="n">width</span><span class="p">())</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
            <span class="n">it</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPointF</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">itRect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span> <span class="o">+</span> <span class="n">innerOffset</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="p">:</span>
                <span class="n">offset</span><span class="o">.</span><span class="n">setX</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">+</span><span class="p">(</span><span class="n">selfWidth</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">())</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_final</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>



<span class="c">#########################################################################################################</span>
<span class="c"># class AleaQGraphicsLabelWidget(QtGui.QGraphicsWidget):                                                #</span>
<span class="c">#     def __init__(self, label, parent=None):                                                           #</span>
<span class="c">#         QtGui.QGraphicsWidget.__init__(self, parent)                                                  #</span>
<span class="c">#         self.__label = QtGui.QGraphicsSimpleTextItem(self)                                            #</span>
<span class="c">#         font = self.__label.font()                                                                    #</span>
<span class="c">#         font.setBold(True)                                                                            #</span>
<span class="c">#         self.__label.setText(label)                                                                   #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def boundingRect(self):                                                                           #</span>
<span class="c">#         return self.__label.boundingRect()                                                            #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def shape(self):                                                                                  #</span>
<span class="c">#         return self.__label.shape()                                                                   #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def size(self):                                                                                   #</span>
<span class="c">#         return self.boundingRect().size()                                                             #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def sizeHint(self, blop, blip):                                                                   #</span>
<span class="c">#         return self.size()                                                                            #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def setText(self, text):                                                                          #</span>
<span class="c">#         self.__label.setText(text)                                                                    #</span>
<span class="c">#         self.updateGeometry()                                                                         #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def paint(self, painter, paintOpts, widget):                                                      #</span>
<span class="c">#         self.__label.paint(painter, paintOpts, widget)                                                #</span>
<span class="c">#                                                                                                       #</span>
<span class="c"># class AleaQGraphicsProxyWidget(QtGui.QGraphicsProxyWidget):                                           #</span>
<span class="c">#     &quot;&quot;&quot;Embed a QWidget in a QGraphicsItem without the ugly background.                                #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     When embedding for ex. a QLabel in a QGraphicsLayout using the normal                             #</span>
<span class="c">#     QGraphicsProxyWidget, the QLabel is rendered with its ugly background                             #</span>
<span class="c">#     and the custom drawing of the QGraphicsItem is hidden.                                            #</span>
<span class="c">#     This class overrides the painting routine or the QGraphicsProxyWidget                             #</span>
<span class="c">#     to paint the child widget without the background.                                                 #</span>
<span class="c">#     &quot;&quot;&quot;                                                                                               #</span>
<span class="c">#     def __init__(self, widget, parent=None):                                                          #</span>
<span class="c">#         &quot;&quot;&quot;                                                                                           #</span>
<span class="c">#         Ctor.                                                                                         #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#         :Parameters:                                                                                  #</span>
<span class="c"># 	 - widget (QtGui.QWidget) - The QWidget to embed                                                #</span>
<span class="c"># 	 - parent (QtGui.QGraphicsItem) - Reference to the parent.                                      #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#         &quot;&quot;&quot;                                                                                           #</span>
<span class="c">#         QtGui.QGraphicsProxyWidget.__init__(self, parent)                                             #</span>
<span class="c">#         self.setWidget(widget)                                                                        #</span>
<span class="c">#         self.__noMouseEventForward = True                                                             #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def event(self, event):                                                                           #</span>
<span class="c">#         #needed or else it catches events before getting to the nodes in dataflowviews and            #</span>
<span class="c">#         #makes tooltips invisible.                                                                    #</span>
<span class="c">#         if(event.type()==QtCore.QEvent.GraphicsSceneHoverMove and self.__noMouseEventForward):        #</span>
<span class="c">#             event.ignore()                                                                            #</span>
<span class="c">#             return True                                                                               #</span>
<span class="c">#         return QtGui.QGraphicsProxyWidget.event(self, event)                                          #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def setMouseEventForward(self, val):                                                              #</span>
<span class="c">#         self.__noMouseEventForward = val                                                              #</span>
<span class="c">#                                                                                                       #</span>
<span class="c">#     def setWidget(self, widget):                                                                      #</span>
<span class="c">#         widget.setBackgroundRole(QtGui.QPalette.Background)                                           #</span>
<span class="c">#         widget.setAutoFillBackground(True)                                                            #</span>
<span class="c">#         widget.setStyleSheet(&quot;background-color: transparent&quot;)                                         #</span>
<span class="c">#         QtGui.QGraphicsProxyWidget.setWidget(self, widget)                                            #</span>
<span class="c">#########################################################################################################</span>

</div></div>
<div class="viewcode-block" id="AleaQMenu"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQMenu">[docs]</a><span class="k">class</span> <span class="nc">AleaQMenu</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QMenu</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">arg2</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QMenu</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QMenu</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)</span>

<div class="viewcode-block" id="AleaQMenu.move"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.AleaQMenu.move">[docs]</a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">())</span>
        <span class="c">#fix the position of the menu if it tries to popup too close to the lower &amp; right edges.</span>
        <span class="c">#bad fixing strategy probably: what if we were create arabian menus?</span>
        <span class="c">#We should maybe sublcass QMenu to handle screen real estate and reuse it.</span>
        <span class="n">desktopGeom</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">desktop</span><span class="p">()</span><span class="o">.</span><span class="n">availableGeometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
        <span class="n">contained</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">qrect_contains</span><span class="p">(</span><span class="n">desktopGeom</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contained</span> <span class="ow">and</span> <span class="n">edges</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">edges</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="n">edges</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">rect</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QMenu</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">())</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QMenu</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="qrect_contains"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.qrect_contains">[docs]</a><span class="k">def</span> <span class="nf">qrect_contains</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">proper</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">r1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
    <span class="k">assert</span> <span class="n">r2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
    <span class="n">dl</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">db</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
    <span class="n">contains</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="n">r1</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">proper</span><span class="p">):</span>
        <span class="n">contains</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">elif</span> <span class="n">r1</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">r2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">r2</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">r1</span><span class="o">.</span><span class="n">left</span><span class="p">():</span>
            <span class="n">dl</span> <span class="o">=</span> <span class="n">r1</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">-</span> <span class="n">r2</span><span class="o">.</span><span class="n">left</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">r2</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="o">.</span><span class="n">right</span><span class="p">():</span>
            <span class="n">dr</span> <span class="o">=</span> <span class="n">r1</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">-</span> <span class="n">r2</span><span class="o">.</span><span class="n">right</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">r2</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">r1</span><span class="o">.</span><span class="n">top</span><span class="p">():</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">r1</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">-</span> <span class="n">r2</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">r2</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">r1</span><span class="o">.</span><span class="n">bottom</span><span class="p">():</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">r1</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">-</span> <span class="n">r2</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">contains</span><span class="p">,</span> <span class="p">(</span><span class="n">dl</span><span class="p">,</span><span class="n">dr</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">db</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="mixin_method"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.mixin_method">[docs]</a><span class="k">def</span> <span class="nf">mixin_method</span><span class="p">(</span><span class="n">mixinOne</span><span class="p">,</span> <span class="n">mixinTwo</span><span class="p">,</span> <span class="n">methodname</span><span class="p">,</span> <span class="n">firstWins</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">caller</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A function that returns a method calling method \&quot;methodname\&quot;</span>
<span class="sd">    from mixinOne and then from mixinTwo, or the reverse order</span>
<span class="sd">    if invert is True.</span>
<span class="sd">    Can be used to quickly reimplement simple overloads.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">first</span> <span class="o">=</span>  <span class="bp">None</span>
    <span class="n">second</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">invert</span><span class="p">):</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">mixinOne</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mixinOne</span><span class="p">,</span> <span class="n">methodname</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">second</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">mixinTwo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mixinTwo</span><span class="p">,</span> <span class="n">methodname</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">second</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">mixinOne</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mixinOne</span><span class="p">,</span> <span class="n">methodname</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="p">(</span><span class="n">mixinTwo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mixinTwo</span><span class="p">,</span> <span class="n">methodname</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">simple_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mixin_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">firstWins</span><span class="p">):</span> <span class="k">return</span> <span class="n">v1</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">v2</span>

    <span class="k">if</span><span class="p">(</span><span class="n">second</span> <span class="ow">and</span> <span class="n">first</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">second</span>
        <span class="n">second</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span><span class="p">(</span><span class="n">first</span> <span class="ow">and</span> <span class="n">second</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">simple_call</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mixin_call</span>

</div>
<div class="viewcode-block" id="extend_qt_scene_event"><a class="viewcode-back" href="../../../openalea/grapheditor/doc/user/autosum.html#openalea.grapheditor.qtutils.extend_qt_scene_event">[docs]</a><span class="k">def</span> <span class="nf">extend_qt_scene_event</span><span class="p">(</span><span class="n">qtcls</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">event_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">GraphicsSceneMouseMove</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moveEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">Show</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polishEvent</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qtcls</span><span class="o">.</span><span class="n">sceneEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event_handler</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">OpenAlea community website</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, INRIA VirtualPlants.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3a0.
    </div>
  </body>
</html>